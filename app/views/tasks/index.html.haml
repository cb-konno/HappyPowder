= render 'layouts/task/header', page_title: @page_title

#search
  = search_form_for @q do |f|
    = f.label Task.human_attribute_name :name
    = f.search_field :name_cont
    = f.label Task.human_attribute_name :priority
    = f.select :priority_eq,
      Task.priorities.map { |k, v| [t("task.priority.#{k}"), v] },
      include_blank: t('select.default')
    = f.label Task.human_attribute_name :status
    = f.select :status_eq,
      Task.statuses.map { |k, v| [t("task.status.#{k}"), v] },
      include_blank: t('select.default')
    = f.submit t('submit.search')

%table#index
  %tr
    %th
      = Task.human_attribute_name :id
    %th
      = Task.human_attribute_name :name
    %th
      = Task.human_attribute_name :description
    %th
      = Task.human_attribute_name :status
    %th
      = sort_link @q, :priority, Task.human_attribute_name(:priority)
    %th
      = Task.human_attribute_name :started_on
    %th
      = sort_link @q, :ended_on, Task.human_attribute_name(:ended_on)
    %th
      = sort_link @q, :created_at, Task.human_attribute_name(:created_at)
    %th
      = Task.human_attribute_name :action
  - @tasks.each do |task|
    %tr
      %td
        = task.id
      %td
        = task.name
      %td
        = task.description
      %td
        = t("task.status.#{task.status}")
      %td
        = t("task.priority.#{task.priority}")
      %td
        = task.started_on
      %td
        = task.ended_on
      %td
        = task.created_at
      %td.menu
        = link_to t(:link_to_show), task_path(task)
        ／
        = link_to t(:link_to_edit), edit_task_path(task)
        ／
        = link_to t(:link_to_delete), task, method: :delete , data: { confirm: t('confirm.delete', target: Task.model_name.human) }

= render 'layouts/task/footer'
